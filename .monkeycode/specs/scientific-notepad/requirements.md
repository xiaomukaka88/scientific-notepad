# 需求文档

## 引言

科学记事本是一个桌面应用程序，集成了文本编辑和科学计算功能。用户可以在记事本中输入文字、粘贴图片，并使用科学计算器进行数学运算。系统支持自动保存功能，确保用户数据不会丢失。

## 词汇表

- **科学记事本**：本应用程序，提供文本编辑和科学计算功能的桌面应用
- **文本编辑器**：用于输入和编辑多行文字的组件
- **科学计算器**：提供高级数学运算功能的模块
- **图片管理器**：处理图片粘贴、存储和显示的组件
- **自动保存**：定期或在特定事件触发时自动保存内容的功能
- **外部引用**：将图片保存为独立文件，在文档中通过路径引用
- **嵌入文档**：将图片数据直接编码并存储在文档文件中
- **窗口透明度**：调整应用程序窗口透明程度的功能
- **字体大小**：文本编辑器中文字的显示尺寸
- **置顶显示**：保持应用程序窗口始终显示在其他窗口之上

## 需求

### 需求 1：文本编辑功能

**用户故事：** 作为用户，我想要输入和编辑多行文字，以便记录笔记和想法。

#### Acceptance Criteria

1. WHEN 用户在文本编辑器中输入内容，科学记事本 SHALL 在光标位置显示输入的字符
2. WHEN 用户按下 Enter 键，科学记事本 SHALL 在当前位置创建新的一行
3. WHILE 用户正在编辑文本，科学记事本 SHALL 支持基本的文本编辑操作（复制、剪切、粘贴、删除）
4. WHEN 用户使用键盘快捷键 Ctrl+Z，科学记事本 SHALL 撤销上一次文本编辑操作
5. WHEN 用户使用键盘快捷键 Ctrl+Y，科学记事本 SHALL 重做被撤销的文本编辑操作

### 需求 2：科学计算功能

**用户故事：** 作为用户，我想要进行科学计算，以便处理复杂的数学运算。

#### Acceptance Criteria

1. WHEN 用户在科学计算器界面输入数学表达式，科学记事本 SHALL 支持基础运算（加、减、乘、除、取模）
2. WHEN 用户在科学计算器界面输入数学表达式，科学记事本 SHALL 支持三角函数（sin、cos、tan）
3. WHEN 用户在科学计算器界面输入数学表达式，科学记事本 SHALL 支持反三角函数（asin、acos、atan）
4. WHEN 用户在科学计算器界面输入数学表达式，科学记事本 SHALL 支持对数函数（log、ln）
5. WHEN 用户在科学计算器界面输入数学表达式，科学记事本 SHALL 支持指数和幂运算（exp、pow、sqrt）
6. WHEN 用户输入的数学表达式包含括号，科学记事本 SHALL 按照运算优先级正确计算表达式
7. IF 用户的数学表达式包含语法错误，科学记事本 SHALL 显示错误提示信息
8. WHEN 计算结果为无限大或无法计算，科学记事本 SHALL 显示相应的错误或特殊值提示

### 需求 3：图片粘贴功能

**用户故事：** 作为用户，我想要粘贴图片到记事本中，以便在笔记中包含视觉信息。

#### Acceptance Criteria

1. WHEN 用户在文本编辑器中粘贴剪贴板中的图片，科学记事本 SHALL 在光标位置插入图片
2. WHILE 用户粘贴图片时，科学记事本 SHALL 显示存储方式选择对话框（外部引用或嵌入文档）
3. WHEN 用户选择外部引用方式，科学记事本 SHALL 将图片保存到指定目录并在文档中创建引用
4. WHEN 用户选择嵌入文档方式，科学记事本 SHALL 将图片数据编码并存储在文档中
5. WHEN 图片插入文档后，科学记事本 SHALL 支持调整图片的显示尺寸
6. WHEN 图片插入文档后，科学记事本 SHALL 支持从文档中删除图片

### 需求 4：图片序列化与解析器

**用户故事：** 作为系统，我需要能够序列化和解析文档中的图片数据，以便正确保存和加载图片。

#### Acceptance Criteria

1. WHEN 保存文档时，科学记事本 SHALL 将所有图片数据序列化为 JSON 或 XML 格式
2. WHEN 加载文档时，科学记事本 SHALL 解析序列化的图片数据并正确显示
3. WHEN 执行图片序列化和解析的往返测试，科学记事本 SHALL 确保原始图片数据与往返后的数据完全一致
4. IF 图片数据在序列化或解析过程中出现错误，科学记事本 SHALL 显示错误信息并跳过该图片

### 需求 5：自动保存功能

**用户故事：** 作为用户，我想要应用自动保存我的内容，以便防止数据丢失。

#### Acceptance Criteria

1. WHEN 用户关闭科学记事本应用程序，科学记事本 SHALL 自动保存当前文档内容
2. WHILE 文档内容有未保存的更改，科学记事本 SHALL 在后台定期自动保存（间隔时间不超过 5 分钟）
3. WHEN 自动保存操作完成，科学记事本 SHALL 更新上次保存时间戳显示
4. IF 自动保存操作失败，科学记事本 SHALL 显示错误提示并尝试在下次操作时重新保存
5. WHEN 科学记事本重新启动，科学记事本 SHALL 自动加载上次保存的文档内容

### 需求 6：文档管理功能

**用户故事：** 作为用户，我想要创建、打开和保存文档，以便管理我的笔记文件。

#### Acceptance Criteria

1. WHEN 用户选择新建文档，科学记事本 SHALL 清空当前编辑器内容
2. WHEN 用户选择打开文档，科学记事本 SHALL 显示文件选择对话框
3. WHEN 用户选择一个有效的文档文件，科学记事本 SHALL 解析并加载文档内容到编辑器
4. WHEN 用户选择保存文档，科学记事本 SHALL 将当前内容序列化并保存到文件
5. WHEN 用户选择另存为，科学记事本 SHALL 显示文件选择对话框并保存到新位置
6. IF 当前文档有未保存的更改且用户尝试新建或打开其他文档，科学记事本 SHALL 提示用户保存当前更改

### 需求 7：用户界面

**用户故事：** 作为用户，我想要直观易用的界面，以便高效使用科学记事本。

#### Acceptance Criteria

1. WHILE 科学记事本应用程序运行，科学记事本 SHALL 显示包含文本编辑器和科学计算器的窗口
2. WHEN 用户启动应用程序，科学记事本 SHALL 提供菜单栏（文件、编辑、视图、帮助）
3. WHEN 用户点击菜单项，科学记事本 SHALL 显示相应的子菜单或执行对应操作
4. WHEN 用户调整窗口大小，科学记事本 SHALL 自适应调整界面布局
5. WHEN 系统主题为深色模式，科学记事本 SHALL 支持深色界面主题
6. WHEN 用户在视图中选择窗口透明度设置，科学记事本 SHALL 显示透明度调节滑块（范围 20% 到 100%）
7. WHEN 用户调整窗口透明度滑块，科学记事本 SHALL 实时更新窗口透明程度
8. WHEN 重新启动应用程序，科学记事本 SHALL 恢复上次的窗口透明度设置
9. WHEN 用户在视图中选择字体大小设置，科学记事本 SHALL 显示字体大小调节控件（范围 10px 到 32px）
10. WHEN 用户调整字体大小，科学记事本 SHALL 实时更新文本编辑器中的文字显示尺寸
11. WHEN 重新启动应用程序，科学记事本 SHALL 恢复上次的字体大小设置
12. WHEN 用户在视图中选择置顶显示选项，科学记事本 SHALL 将窗口设置为始终显示在其他窗口之上
13. WHEN 用户取消置顶显示选项，科学记事本 SHALL 取消窗口置顶状态
14. WHEN 重新启动应用程序，科学记事本 SHALL 恢复上次的置顶显示设置
